# ①課題番号-プロダクト名
- 09-ブックマークアプリ(更新・削除)

## ②課題内容（どんな作品か）

- 前回制作した契約管理ツールで、更新・削除処理を追加しました
- 合わせてOGP画像で重たくなってしまっていた課題も対応しました
    - 初回登録時にOGP画像のurlを取得してDBに保存し、画面描画時はその情報をDBから取得して表示します（今までは描写時にリンク先のサイトにアクセスしてOGP画像拾ってました）
    - 一応OGPも更新されることがあると思うので、更新処理の際に再度OGP画像を取得する仕組みにしました
- 絞り込み（検索）機能も追加しました。キーワードと色で絞り込めるようにしています。両方入れてもOKですし、片方だけでもOKです。
    - 将来的に類似サービスをする際に何か区分で絞り込むようにするとは思うのですが、色もその難しいバージョンになると思ったので、今回実装してみました。

## ③DEMO
- https://chisaxworks.sakura.ne.jp/gs_kadai09_php3/

## ④作ったアプリケーション用のIDまたはPasswordがある場合
- ID: 今回なし
- PW: 今回なし

## ⑤工夫した点・こだわった点
- 削除については、用途としてあまり頻繁にはないので、編集画面上で削除するUIとしました。それに伴いhoverカラーは分かりやすく修正しています。
- 絞り込み機能について
    - UIは悩んだのですが、一覧の見出しの下にある方が意味的には分かりやすいかと思い、そのようにしました（登録とはボタン配置・デザインが異なる）
    - 基本的な絞り込み機能に加えて（両方で検索とかクリアで解除とか）、絞り込んだ後に入力したキーワードや色が残るようにして、toggleも閉じないようにしました。

## ⑥難しかった点・次回トライしたいこと(又は機能)
- 更新削除については、基本は講座の内容をベースにしたのでそこまで難しくはなかったですが、selectやradioボタンでDBの値を初期表示するのは、静的なものはありましたが、DBの値を元にする方法はぐぐってもヒットせずChatGPTに確認しました。
- 絞り込み機能については ワード絞り込みの部分一致で、バインド変数にするという点に一番調査に時間がかかりました。

## ⑦質問・疑問・感想、シェアしたいこと等なんでも
- OGP画像の影響で重くなってしまった件の対処については最終的に3つの案を試しました
    - 1回目の案
        - 非同期処理を行おうと思い、一度画像はnoimageを描画して（これが先の処理）、その後にOGP画像を取得・描画することを考えましたが、そもそも先の処理の方のhtmlタグはphpで変数を埋め込みながら作っている（授業でもあった「$view .= 」）ため、そのhtmlタグの中に更にphpの変数を入れるというのが難しく断念しました
    - 2回目の案
        - 後から差し込むimgタグをjQueryで行うのはどうか（以前の神経衰弱でやった処理と同様）と思い、phpでOGP画像のURLを配列→JSONにして、それをjsで読み込ませてimgタグをhtmlに挿入するやり方を考えました。ただ、imgタグをhtmlに挿入するにあたり、どのdivに差し込むのかidを保持する必要があり、そうなるとphpの配列は連想配列（idとogpのURL）にする必要があることに気づいたあたりで、3回目の案の方が圧倒的に楽だと思い、方針転換しました。
    - 3回目の案（今回採用）
        - 初回登録時にOGP画像のurlを取得してDBに保存し、画面描画時はその情報をDBから取得して表示する これによってコードもさほど複雑にならずにすみました
- 絞り込み機能で活用した参考記事
    - 部分一致のバインド関数：https://qiita.com/Takahiro_Inoway/items/bbe61e69b7df6599926e
    - 入力した値を保持したままにする（Valueに値を入れる）：https://metrograph.jp/wp-search-words/
    - PHPからjsへ値を渡す（こちらの一番上のstring部分）：https://qiita.com/yuuto_odo/items/56c5b5f3dd3d8e28a4c0